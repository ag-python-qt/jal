# JAL
Just Another Ledger - это проект для учета личных финансов

[![image](http://img.shields.io/pypi/v/jal.svg)](https://pypi.python.org/pypi/jal/)

*[English](https://github.com/titov-vv/jal/blob/master/docs/README.md), [Русский](https://github.com/titov-vv/jal/blob/master/docs/README.ru.md)*

Он создавался, чтобы учитывать личные доходы/расходы и инвестиции с актуальной информацией о состоянии счетов и оценочной стоимости портфеля ценных бумаг.

### Поддержка, обратная связь
Если вы хотите задать вопрос, сообщить о проблеме, помочь или поддержать автора - это можно сделать через email [jal@gmx.ru](mailto:jal@gmx.ru?subject=%5BJAL%5D%20Help) или в [Telegram](https://t.me/jal_support) (создание [Issues](https://github.com/titov-vv/jal/issues) на GitHub тоже приветствуется).

### Спасибки!
Я бы хотел упомянуть людей, кто помогал мне в 2022-м, т.к. я получил больше пожертвований, помощи и отзывов от пользователей в этом году.
И хотя я не могу назвать их всех по именам, я подтверждаю свою искреннюю признательность за их помощь. Они сделали проект лучше! 

### [FAQ (часто задаваемые вопросы)](https://github.com/titov-vv/jal/blob/master/docs/FAQ.ru.md)

### [Описание сообщений об ошибках](https://github.com/titov-vv/jal/blob/master/docs/error_description.ru.md)

### Основные возможности
- Ведение учета по нескольким счетам в разных валютах (с возможностью выбора основной валюты для итоговых сумм)
- 5 типов операций: 
    1. Обычный доход/расход, который может быть разделён на несколько категорий
    2. Перевод ценных бумаг и денежных средств между разными счетами (с конверсией валюты при необходимости)
    3. Операции Покупки/Продажи ценных бумаг (*jal* поддерживает акции, облигации, опционы, частично поддерживает облигации и фьючерсы)
    4. Дивиденды по акциям и купонные выплаты по облигациям
    5. Корпоративные события для акций с учётом долей активов (Сплит, Смена символа, Выделение/Объединение компаний, Дивиденд акциями компании)
- Основные отчеты:
    1. помесячный отчет доходов/расходов по категориям
    2. отчет о прибылях/убытках для инвестиционных счетов
    3. отчет по завершённым сделкам с ценными бумагами
- Обновление котировок для акций, торгуемых на NYSE, Nasdaq, LSE, Frankfurt (Yahoo), Euronext, TSX и MOEX.
- Курс валют могут загружаться с сайтов Европейского и/или Российского центральных банков.
- Импорт брокерских отчетов:
    1. Российские: Уралсиб Кэпитал (zipped xls), КИТ Финанс (xlsx), ПСБ-брокер (xls), Открытие-брокер (xml).
    2. Мировые: Interactive Brokers (xml Flex-отчёт), Just2Trade (xls).
- Оценка предполагаемого налога к уплате по текущей котировке открытой позиции 
- Отчет для подготовки налоговой декларации по результатам операций с зарубежными ЦБ для России (![инструкция](https://github.com/titov-vv/jal/blob/master/docs/ru-tax-3ndfl/taxes.md)) и Португалии (*черновик*)
- *экспериментальная* Загрузка электронных чеков с сайта ФНС России. Для использования этой функции вам понадобится авторизоваться и установить пакет `pyzbar` для распознавания QR-кодов.  
Вы можете авторизоваться через SMS, логин/пароль личного кабинета или Госуслуги. QR-код может быть отсканирован камерой, либо распознан с изображения в буфере обмена или файле.
- *экспериментальное* Распознавание категорий товаров из загруженных электронных чеков с помощью `tensorflow` 
    

### Установка

#### *jal* не работает с версией PySide6 6.5.0. Пожалуйста используйте версию 6.4.3 или ниже.

*jal* создавался как переносимое приложение. Поэтому есть несколько способов установки программы:
- Вы можете скачать/клонировать код из [GitHub репозитория](https://github.com/titov-vv/jal), распаковать его в подходящий каталог на вашем компьютере и использовать `run.py` для старта приложения.
Чтобы всё сработало вам нужен Python версии не ниже 3.8.1 и необходимо удовлетворить зависимости из `requirements.txt`.
Так как приложение оказалось востребовано среди людей, далеких от программирования, хочется немного сказать об установке Python на windows-системах.
Лучше всего Python скачивать с официального сайта. При запуске установщика в настройках обязательно указать установку pip и, в расширенных настройках, добавить Python в переменные окружения. Не забудьте перезагрузиться, чтобы внесенные изменения гарантированно применились.
- Вы можете установить пакет с помощью команды `pip install jal`. Она автоматически установит необходимые зависимости и создат скрипт `jal` для запуска<sup>*</sup> приложения. Для windows-пользователей надо запустить приложение командной строки windows (cmd) и выполнить вышеозвученную команду в нем. 
Если Python установлен правильно и установка *jal* пройдёт успешно, то вы сможете запускать приложение простой командой `jal`.
Также вы можете запустить приложение командой `python -m jal.jal`, если по какой-то причине вы не можете запустить её с помощью скрипта `jal`.
- Также можно смешать оба метода вместе - скачать исходный код с github и использовать `setup.py` удобным для вас способом.
он не требует каких-то специфичных инструкций по установке. Все что вам нужно - это иметь Python 3.8.1 или выше и установленные пакеты из раздела Зависимости.

База данных программы будет инициализирована автоматически минимально необходимым набором данных и вы сможете начать использовать приложение.

Для смены языка с Английского на Русский нужно выбрать пункт меню Languages->Russian и перезапустить программу

<sup>*</sup> - место создания скрипта зависит от операционной системы. Например, на Linux это может быть `~/.local/run`, на Windows - подкаталог `Scripts` каталога, где установлен python или каталог `Appdata/Roaming/Python/.../Scripts/` в профиле пользователя.

### Обновление
Если вы установили программу с помощью *pip*, то обновить на новую версию можно при помощи команды `pip install jal -U`.

### Скриншоты
Основные скриншоты можно посмотреть на англоязычной версии данной страницы - они отличаются только языком.
Ниже представлены скриншоты функционала актуального только для России.

### Налоговый отчет по операциям с иностранными ценными бумагами

Налоговый отчёт может быть подготовлен по операциям любого брокера, если они присутствуют в программе. На данный момент поддерживаются налоговые отчёты для России и Португалии.  
Операции могут быть загружены из отчёта брокера - список поддерживаемых брокеров можно увидеть в меню *Импорт->Отчёт*.  
Пошаговая инструкция по подготовке данных для российской декларации 3-НДФЛ на основе отчета Interactive Brokers расположена на [отдельной странице](https://github.com/titov-vv/jal/blob/master/docs/ru-tax-3ndfl/taxes.md).
По вопросам поддержки отчётов можно связаться через контакты указанные в начале этой страницы.

### Загрузка электронных чеков с сайта ФНС

Диалог авторизации (выбрана страница с авторизацией через Госуслуги):  
![FSN authorization dialog](https://github.com/titov-vv/jal/blob/master/docs/img/fns_auth_dialog.png?raw=true)

Диалог импорта чека:  
![Electronic slip import dialog](https://github.com/titov-vv/jal/blob/master/docs/img/slip_import.png?raw=true) 

